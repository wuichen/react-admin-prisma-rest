# Migration `20200526163055-er`

This migration has been generated by I Chen Wu at 5/26/2020, 4:30:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Customers" (
"address" text   ,"avatar" text   ,"birthday" timestamp(3)   ,"city" text   ,"email" text  NOT NULL ,"first_name" text  NOT NULL ,"first_seen" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"groups" text []  ,"has_newsletter" boolean   DEFAULT false,"has_ordered" boolean   DEFAULT false,"id" integer  NOT NULL ,"last_name" text  NOT NULL ,"last_seen" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"latest_purchase" timestamp(3)   ,"nb_commands" integer   ,"total_spent" Decimal(65,30)   DEFAULT 0,"zipcode" text   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Categories" (
"id" integer  NOT NULL ,"name" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Products" (
"category_id" integer   ,"description" text   ,"height" Decimal(65,30)   ,"id" integer  NOT NULL ,"image" text   ,"price" Decimal(65,30)   ,"reference" text   ,"stock" integer   ,"thumbnail" text   ,"width" Decimal(65,30)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Baskets" (
"command_id" integer  NOT NULL ,"id" SERIAL,"product_id" integer  NOT NULL ,"quantity" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Commands" (
"customer_id" integer   ,"date" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"delivery_fees" Decimal(65,30)   ,"id" integer  NOT NULL ,"reference" text   ,"returned" boolean   ,"status" text   ,"tax_rate" Decimal(65,30)   ,"taxes" Decimal(65,30)   ,"total" Decimal(65,30)   ,"total_ex_taxes" Decimal(65,30)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Invoices" (
"command_id" integer   ,"customer_id" integer   ,"date" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"delivery_fees" Decimal(65,30)   ,"id" integer  NOT NULL ,"tax_rate" Decimal(65,30)   ,"taxes" Decimal(65,30)   ,"total" Decimal(65,30)   ,"total_ex_taxes" Decimal(65,30)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Reviews" (
"command_id" integer   ,"comment" text   ,"customer_id" integer   ,"date" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"id" integer  NOT NULL ,"product_id" integer   ,"rating" integer   ,"status" text   ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Products" ADD FOREIGN KEY ("category_id")REFERENCES "public"."Categories"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Baskets" ADD FOREIGN KEY ("command_id")REFERENCES "public"."Commands"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Baskets" ADD FOREIGN KEY ("product_id")REFERENCES "public"."Products"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Commands" ADD FOREIGN KEY ("customer_id")REFERENCES "public"."Customers"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Invoices" ADD FOREIGN KEY ("command_id")REFERENCES "public"."Commands"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Invoices" ADD FOREIGN KEY ("customer_id")REFERENCES "public"."Customers"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Reviews" ADD FOREIGN KEY ("command_id")REFERENCES "public"."Commands"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Reviews" ADD FOREIGN KEY ("product_id")REFERENCES "public"."Products"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Reviews" ADD FOREIGN KEY ("customer_id")REFERENCES "public"."Customers"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200526162632-ini..20200526163055-er
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("PRISMA_POSTGRES_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -24,17 +24,17 @@
   has_newsletter  Boolean?   @default(false)
   groups          String[]
   nb_commands     Int?
   total_spent     Float?     @default(0)
-  Review          Reviews[]
-  Invoice         Invoices[]
-  Command         Commands[]
+  reviews         Reviews[]
+  invoices        Invoices[]
+  commands        Commands[]
 }
 model Categories {
-  id      Int        @id
-  name    String
-  Product Products[]
+  id       Int        @id
+  name     String
+  products Products[]
 }
 model Products {
   id          Int         @id
@@ -47,10 +47,10 @@
   thumbnail   String?
   image       String?
   description String?
   stock       Int?
-  Review      Reviews[]
-  Basket      Baskets[]
+  review      Reviews[]
+  basket      Baskets[]
 }
 model Baskets {
   id         Int      @default(autoincrement()) @id
@@ -66,19 +66,18 @@
   reference      String?
   date           DateTime?  @default(now())
   customer_id    Int?
   customer       Customers? @relation(fields: [customer_id], references: [id])
-  basket         Json?
   total_ex_taxes Float?
   delivery_fees  Float?
   tax_rate       Float?
   taxes          Float?
   total          Float?
   status         String?
   returned       Boolean?
-  Invoice        Invoices[]
-  Review         Reviews[]
-  Basket         Baskets[]
+  invoice        Invoices[]
+  review         Reviews[]
+  basket         Baskets[]
 }
 model Invoices {
   id             Int        @id
```


